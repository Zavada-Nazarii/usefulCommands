# SMTP Pentesting Guide

–¶–µ–π –≥–∞–π–¥ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ SMTP-—Å–µ—Ä–≤—ñ—Å—ñ–≤, —â–æ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –ø–æ—Ä—Ç–∞—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 25, 465, 587). –í—ñ–Ω –æ—Ö–æ–ø–ª—é—î —Ç–µ—Ö–Ω—ñ–∫–∏ –∑–±–æ—Ä—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–∞ Open Relay, –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é, –±—Ä—É—Ç—Ñ–æ—Ä—Å —ñ –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–º–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π.

---

## üîπ –¶—ñ–ª—å–æ–≤—ñ –ø–æ—Ä—Ç–∏ SMTP

| –ü–æ—Ä—Ç | –ü—Ä–æ—Ç–æ–∫–æ–ª         | –û–ø–∏—Å                             |
|------|------------------|----------------------------------|
| 25   | SMTP             | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ –±–µ–∑ TLS      |
| 465  | SMTPS (SSL)      | SMTP —á–µ—Ä–µ–∑ SSL (–∑–∞—Å—Ç–∞—Ä—ñ–ª–∏–π)      |
| 587  | SMTP + STARTTLS  | SMTP –∑ TLS (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π)      |

---

## üîπ –ï—Ç–∞–ø–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ SMTP

### 1. üîç Banner Grabbing

```bash
nc <ip> 25
telnet <ip> 587
openssl s_client -connect <ip>:465
```

### 2. üì® –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ Open Relay

```bash
swaks --to test@example.com --from test@victim.local --server <ip> --port 25
swaks --to test@external.com --from test@victim.local --server <ip> --port 587
```

### 3. üîê –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ AUTH

```bash
swaks --auth LOGIN --auth-user test --auth-password test --server <ip> --port 587
```

–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫—É:
```bash
swaks --ehlo --server <ip> --port 587
```

### 4. üí£ –ë—Ä—É—Ç—Ñ–æ—Ä—Å —á–µ—Ä–µ–∑ Hydra

```bash
hydra -S -V -s 587 -L users.txt -P rockyou.txt smtp://<ip>
```

- `-S` ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ SSL/TLS
- `-L users.txt` ‚Äî —Å–ø–∏—Å–æ–∫ —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- `-P rockyou.txt` ‚Äî —Å–ª–æ–≤–Ω–∏–∫ –ø–∞—Ä–æ–ª—ñ–≤

### 5. üîí TLS/SSL –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞

```bash
testssl.sh <ip>:587
```

### 6. üõ†Ô∏è Nmap —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –Ω–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ

```bash
nmap -p 25,465,587 --script smtp* <ip>
```


## üîπ –ö–æ—Ä–∏—Å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

- **swaks** ‚Äì SMTP —Ç–µ—Å—Ç–æ–≤–∏–π –∫–ª—ñ—î–Ω—Ç
- **hydra** ‚Äì –±—Ä—É—Ç—Ñ–æ—Ä—Å –ª–æ–≥—ñ–Ω—ñ–≤/–ø–∞—Ä–æ–ª—ñ–≤
- **nmap** ‚Äì —Å–∫–∞–Ω–µ—Ä –∑ NSE —Å–∫—Ä–∏–ø—Ç–∞–º–∏
- **testssl.sh** ‚Äì –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ TLS/SSL
- **smtp-user-enum** ‚Äì enumeration –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **msfconsole** ‚Äì –º–æ–¥—É–ª—ñ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è Exim)

---

## üîπ –î–æ–¥–∞—Ç–∫–æ–≤—ñ –ø–æ—Ä–∞–¥–∏

- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –º–æ–∂–Ω–∞ —Ñ–∞–ª—å—Å–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ –∞–¥—Ä–µ—Å–∏ (`@victim.local`)
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –ø–∞—Ä–æ–ª—å –≤ –ª–æ–≥–∞—Ö (–ø—Ä–∏ login failed)
- –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ ‚Äî MITM —á–µ—Ä–µ–∑ `Ettercap` + `sslstrip` –∞–±–æ `Bettercap`

---

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤–æ

- –ó–∞–≤–∂–¥–∏ –æ—Ç—Ä–∏–º—É–π –¥–æ–∑–≤—ñ–ª –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è–º —Ç–µ—Å—Ç—ñ–≤.
- –ù–µ —Ä–æ–∑—Å–∏–ª–∞–π —à–∫—ñ–¥–ª–∏–≤—ñ –∞–±–æ —Ñ—ñ—à–∏–Ω–≥–æ–≤—ñ –ª–∏—Å—Ç–∏.
- –î–æ—Ç—Ä–∏–º—É–π—Å—è –µ—Ç–∏—á–Ω–æ–≥–æ —Ö–∞–∫—ñ–Ω–≥—É (white-box / grey-box –º–æ–¥–µ–ª—ñ).

---
